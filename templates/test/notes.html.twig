{% extends 'base.html.twig' %}

{% block title %}Test index{% endblock %}
  {% block stylesheets %}
        {{ encore_entry_link_tags('app') }}
    {% endblock %}

    {% block javascripts %}
   
        {{ encore_entry_script_tags('app') }}
      
    {% endblock %}

{% block body %}

 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>

    <table class="table table-striped">
        <thead>
        <tr>
            <th colspan="4"><h1 style="margin-top: 150px;">Notes Test : {{ test.sujet }}</h1></th>
        </tr>
        <tr>
            <th>Nom & Prenom</th>
            <th>Note</th>
            <th>Status</th>
            <th>Pourcentage </th>
        </tr>
        </thead>
        <tbody>
        {% set percent = test.getTotalPoint() %}
        {% for note in notes %}
            <tr>
                <td>{{ note.idEtudiant.nom }}  {{ note.idEtudiant.prenom }}</td>
                <td>{{ note.noteObtenue }}</td>
                {% if(note.noteObtenue/percent) > 0.7 %}
                    <td>Admis</td>
                {% else %}
                    <td>Echou√©</td>
                {% endif %}
                <td>{{ ((note.noteObtenue/percent)*100) | round }} %</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="6">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
   
     <canvas id="myChart">

  
    </canvas>


    <script>
  var ctx = document.getElementById('myChart').getContext('2d');
  var weightData = {{ datasets|json_encode|raw }};
  var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ labels|json_encode|raw }},
      datasets: [{
        label: 'Notes',
        data: weightData,
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          'rgba(255, 159, 64, 0.2)'
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: true
          }
        }]
      },
      title: {
        display: true,
        text: 'Test Results'
      },
      legend: {
        display: false
      }
    }
  });
  </script>
 
{% endblock %}

